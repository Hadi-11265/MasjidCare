<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Ü‡¶Ø‡¶º-‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ</title>
    <link rel="stylesheet" href="finance.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="navbar">
        <div class="nav-content">
            <h1>‡¶Ü‡¶Ø‡¶º-‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ</h1>
            <div class="nav-actions">
                <span id="admin-status" class="admin-badge" style="display: none;"></span>
                <button id="logout-btn" onclick="handleLogout()" class="logout-btn" style="display: none;">Logout</button>
                <button onclick="window.location.href='index.html'" class="back-btn">‚Üê ‡¶π‡ßã‡¶Æ‡ßá ‡¶´‡¶ø‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Summary Cards -->
        <div class="summary-section">
            <div class="summary-card income-card">
                <div class="card-icon">üìà</div>
                <div class="card-content">
                    <h3>‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶Ø‡¶º</h3>
                    <p class="amount" id="total-income">‡ß¶ ‡ß≥</p>
                    <span class="period" id="income-period">‡¶è‡¶á ‡¶Æ‡¶æ‡¶∏‡ßá</span>
                </div>
            </div>

            <div class="summary-card expense-card">
                <div class="card-icon">üìâ</div>
                <div class="card-content">
                    <h3>‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</h3>
                    <p class="amount" id="total-expense">‡ß¶ ‡ß≥</p>
                    <span class="period" id="expense-period">‡¶è‡¶á ‡¶Æ‡¶æ‡¶∏‡ßá</span>
                </div>
            </div>

            <div class="summary-card balance-card">
                <div class="card-icon">üí∞</div>
                <div class="card-content">
                    <h3>‡¶â‡¶¶‡ßç‡¶¨‡ßÉ‡¶§‡ßç‡¶§</h3>
                    <p class="amount" id="balance">‡ß¶ ‡ß≥</p>
                    <span class="period">‡¶Ü‡¶Ø‡¶º - ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</span>
                </div>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <h2>‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
            <div class="filter-controls">
                <select id="month-filter">
                    <option value="">‡¶∏‡¶¨ ‡¶Æ‡¶æ‡¶∏</option>
                    <option value="01">‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø</option>
                    <option value="02">‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø</option>
                    <option value="03">‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö</option>
                    <option value="04">‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤</option>
                    <option value="05">‡¶Æ‡ßá</option>
                    <option value="06">‡¶ú‡ßÅ‡¶®</option>
                    <option value="07">‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á</option>
                    <option value="08">‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü</option>
                    <option value="09">‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞</option>
                    <option value="10">‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞</option>
                    <option value="11">‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞</option>
                    <option value="12">‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞</option>
                </select>

                <select id="year-filter">
                    <option value="">‡¶∏‡¶¨ ‡¶¨‡¶õ‡¶∞</option>
                    <option value="2025">‡ß®‡ß¶‡ß®‡ß´</option>
                    <option value="2024">‡ß®‡ß¶‡ß®‡ß™</option>
                    <option value="2023">‡ß®‡ß¶‡ß®‡ß©</option>
                </select>

                <button onclick="applyFilter()" class="filter-btn">‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button onclick="resetFilter()" class="reset-btn">‡¶∞‡¶ø‡¶∏‡ßá‡¶ü</button>
            </div>
        </div>

        <!-- Tabs for Income and Expense -->
        <div class="tabs-section">
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('income')">‡¶Ü‡¶Ø‡¶º ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
                <button class="tab-btn" onclick="switchTab('expense')">‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
            </div>

            <!-- Income Section -->
            <div id="income-section" class="tab-content active">
                <div class="section-header">
                    <h2>‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h2>
                    <button id="add-income-btn" onclick="openAddModal('income')" class="add-btn" style="display: none;">+ ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶Ø‡¶º ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                </div>

                <div class="table-container">
                    <table id="income-table">
                        <thead>
                            <tr>
                                <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                <th>‡¶â‡ßé‡¶∏</th>
                                <th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß≥)</th>
                                <th>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</th>
                            </tr>
                        </thead>
                        <tbody id="income-tbody">
                            <tr>
                                <td colspan="4" class="loading">‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="click-hint">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶æ‡¶∞‡¶ø‡¶§‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
            </div>

            <!-- Expense Section -->
            <div id="expense-section" class="tab-content">
                <div class="section-header">
                    <h2>‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h2>
                    <button id="add-expense-btn" onclick="openAddModal('expense')" class="add-btn" style="display: none;">+ ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                </div>

                <div class="table-container">
                    <table id="expense-table">
                        <thead>
                            <tr>
                                <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                <th>‡¶ñ‡¶æ‡¶§</th>
                                <th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß≥)</th>
                                <th>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</th>
                            </tr>
                        </thead>
                        <tbody id="expense-tbody">
                            <tr>
                                <td colspan="4" class="loading">‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="click-hint">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶æ‡¶∞‡¶ø‡¶§‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
            </div>
        </div>

        <!-- Category Breakdown -->
        <div class="breakdown-section">
            <h2>‡¶ñ‡¶æ‡¶§ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</h2>
            
            <div class="breakdown-tabs">
                <button class="breakdown-tab-btn active" onclick="switchBreakdownTab('income')">‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</button>
                <button class="breakdown-tab-btn" onclick="switchBreakdownTab('expense')">‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</button>
            </div>
            
            <div id="income-breakdown" class="breakdown-content active">
                <div id="income-category-breakdown" class="breakdown-grid">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
            
            <div id="expense-breakdown" class="breakdown-content">
                <div id="expense-category-breakdown" class="breakdown-grid">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detail-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDetailModal()">&times;</span>
            <h2 id="detail-title">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶§‡¶•‡ßç‡¶Ø</h2>
            
            <div class="detail-body">
                <div class="detail-row">
                    <label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
                    <span id="detail-date">-</span>
                </div>
                <div class="detail-row">
                    <label id="detail-label-source">‡¶â‡ßé‡¶∏:</label>
                    <span id="detail-source">-</span>
                </div>
                <div class="detail-row">
                    <label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</label>
                    <span id="detail-amount">-</span>
                </div>
                <div class="detail-row">
                    <label>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£:</label>
                    <span id="detail-description">-</span>
                </div>
            </div>
            
            <div class="detail-actions">
                <button onclick="closeDetailModal()" class="close-btn">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="add-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddModal()">&times;</span>
            <h2 id="modal-title">‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶Ø‡¶º ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
            
            <form id="add-form" onsubmit="submitForm(event)">
                <input type="hidden" id="form-type" value="">
                
                <div class="form-group">
                    <label for="source">‡¶â‡ßé‡¶∏/‡¶ñ‡¶æ‡¶§ *</label>
                    <input type="text" id="source" required placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ú‡ßÅ‡¶Æ‡¶æ‡¶∞ ‡¶¶‡¶æ‡¶®, ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡ßÅ‡ßé ‡¶¨‡¶ø‡¶≤">
                </div>

                <div class="form-group">
                    <label for="amount">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß≥) *</label>
                    <input type="number" id="amount" required min="1" step="0.01" placeholder="‡ß¶">
                </div>

                <div class="form-group">
                    <label for="date">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ *</label>
                    <input type="date" id="date" required>
                </div>

                <div class="form-actions">
                    <button type="button" onclick="closeAddModal()" class="cancel-btn">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                    <button type="submit" class="submit-btn">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success/Error Message -->
    <div id="toast" class="toast"></div>

    <script src="finance.js"></script>
    <script>
        // Show logout button if admin is logged in
        window.addEventListener('DOMContentLoaded', () => {
            const isAdmin = localStorage.getItem('admin_logged_in') === 'true';
            if (isAdmin) {
                document.getElementById('logout-btn').style.display = 'block';
            }
        });

        function handleLogout() {
            if (confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                localStorage.removeItem('admin_logged_in');
                localStorage.removeItem('admin_name');
                window.location.href = 'admin_logout.php';
            }
        }
    </script>
</body>
</html>
